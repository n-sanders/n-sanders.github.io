(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[428],{4428:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ee}});var i=a(5893),r=a(7294),n=a(5121),l=a(1163);function s(e,t,a){console.log("gri - playedIds:",a);let i=e.filter(e=>!a.has(e.id));if(0===i.length)return console.log("Out of cards, setting next card as a YOU WIN!"),{date_prop_id:"P571",description:"Congratulations! You've won the game!",id:"you-win-id",label:"You win!",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/e/ee/Russian_Cup_Trophy.png/640px-Russian_Cup_Trophy.png",year:2024};if(0===i.length)return console.error("Unexpectedly ran out of items after shuffling/reset."),e[0];let r=i[Math.floor(Math.random()*i.length)];return console.log("gri - picked, adding:",r.id),a.add(r.id),r}function o(e){let t=new Image;return t.src=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return"https://commons.wikimedia.org/w/index.php?title=Special:Redirect/file/".concat(encodeURIComponent(e),"&width=").concat(t)}(e),t}async function d(e){let t=new Set;console.log("createState!");let a=s(e,[],t);t.add(a.id),console.log("cs - playedIds:",t);let i=[{...a,played:{correct:!0}}],r=s(e,i,t);t.add(r.id),console.log("cs2 - playedIds:",t);let n=s(e,[...i,r],t);t.add(n.id);let l=[o(r.image),o(n.image)];return{badlyPlaced:null,deck:function(e){for(let t=e.length-1;t>0;t--){let a=Math.floor(Math.random()*(t+1));[e[t],e[a]]=[e[a],e[t]]}return e}(e),imageCache:l,lives:3,next:r,nextButOne:n,played:i,playedIds:t}}var c=a(5948),u=a(1e3);async function p(e,t){var a;if(null===e.badlyPlaced||null===e.badlyPlaced.index||!1===e.badlyPlaced.rendered)return;let i=null===(a=t.tryGetLock)||void 0===a?void 0:a.call(t,e.played[e.badlyPlaced.index].id);if(!i)return;let r=document.querySelector("[data-rbd-draggable-id='".concat(e.played[e.badlyPlaced.index].id,"']")),n=document.querySelector("[data-rbd-draggable-id='".concat(e.played[e.badlyPlaced.index+e.badlyPlaced.delta].id,"']")),l=document.getElementById("bottom");if(null===r||null===n||null===l)throw Error("Can't find element");let s=l.scrollLeft+l.clientWidth/4,o=l.scrollLeft+l.clientWidth/4*3-r.clientWidth,d=0;(n.offsetLeft<s||n.offsetLeft>o)&&(d=n.offsetLeft<s?n.offsetLeft-s:n.offsetLeft-o,l.scrollLeft+d<0?d=-l.scrollLeft:l.scrollLeft+d>l.scrollWidth-l.clientWidth&&(d=l.scrollWidth-l.clientWidth-l.scrollLeft));let c=n.offsetLeft-r.offsetLeft-d,p=i.fluidLift({x:0,y:0}),m=[],h=[],f=30+5*Math.abs(e.badlyPlaced.delta);for(let e=0;e<f;e++)m.push(u.easeOutCirc(e,0,c,f)),h.push(u.easeOutCirc(e,l.scrollLeft,l.scrollLeft+d,f));!function e(t,a,i){requestAnimationFrame(()=>{let r=document.getElementById("bottom");if(null===r)throw Error("Can't find #bottom");let n=a.shift(),l=i.shift();void 0===n||void 0===l?t.drop():(r.scrollLeft=l,t.move({x:n,y:0}),e(t,a,i))})}(p,m,h)}var m=a(4184),h=a.n(m),f=a(9926),_=a(4549),g=a.n(_);let y={P575:"discovered",P7589:"date of assent",P577:"published",P1191:"first performed",P1619:"officially opened",P571:"created",P1249:"earliest record",P576:"ended",P8556:"became extinct",P6949:"announced",P1319:"earliest",P569:"born",P570:"died",P582:"ended",P580:"started",P7125:"latest one",P7124:"first one"};function x(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Q(e){let{draggable:t,flippedId:a,index:n,item:l,setFlippedId:s}=e,o=l.id===a,d="you-win-id"===l.id,u=(0,f.q_)({opacity:o?1:0,transform:"perspective(600px) rotateY(".concat(o?180:0,"deg)"),config:{mass:5,tension:750,friction:100}}),p=r.useMemo(()=>{let e=l.description.replace(/ \(.+\)/g,"");return l.description.length<60&&!/\d\d/.test(e)?l.description.replace(/ \(.+\)/g,""):e},[l]);return(0,i.jsx)(c._l,{draggableId:l.id,index:n,isDragDisabled:!t||d,children:(e,t)=>(0,i.jsxs)("div",{className:h()(g().itemCard,{[g().played]:"played"in l,[g().flipped]:o,[g().dragging]:t.isDragging}),ref:e.innerRef,...e.draggableProps,...e.dragHandleProps,onClick:()=>{"played"in l&&s&&(o?s(null):s(l.id))},children:[(0,i.jsxs)(f.q.div,{className:g().front,style:{opacity:u.opacity.to(e=>1-e),transform:u.transform},children:[(0,i.jsxs)("div",{className:g().top,children:[(0,i.jsx)("div",{className:g().label,children:x(l.label)}),(0,i.jsx)("div",{className:g().description,children:x(p)})]}),(0,i.jsx)("div",{className:g().image,style:{backgroundImage:'url("'.concat(l.image,'")')}}),(0,i.jsx)(f.q.div,{className:h()(g().bottom,{[g().correct]:"played"in l&&l.played.correct,[g().incorrect]:"played"in l&&!l.played.correct}),children:(0,i.jsx)("span",{children:"played"in l?l.year<-1e4?l.year.toLocaleString():l.year.toString():y[l.date_prop_id]})})]}),(0,i.jsxs)(f.q.div,{className:g().back,style:{opacity:u.opacity,transform:u.transform.to(e=>"".concat(e," rotateX(180deg) rotateZ(180deg)"))},children:[(0,i.jsx)("span",{className:g().label,children:x(l.label)}),(0,i.jsxs)("span",{className:g().date,children:[x(y[l.date_prop_id]),": ",l.year]}),(0,i.jsxs)("span",{className:g().description,children:[l.description,"."]})]})]})})}var b=a(7678),v=a.n(b);function j(e){let{next:t}=e;return(0,i.jsx)("div",{className:v().container,children:(0,i.jsx)(c.bK,{droppableId:"next",direction:"horizontal",children:e=>(0,i.jsx)("div",{className:v().wrapper,children:(0,i.jsxs)("div",{ref:e.innerRef,...e.droppableProps,className:v().list,children:[t&&(0,i.jsx)(Q,{draggable:!0,index:0,item:t},t.id),e.placeholder]})})})})}var w=a(9112),P=a.n(w);function k(e){let{badlyPlacedIndex:t,isDragging:a,items:n}=e,[l,s]=r.useState(null);return r.useEffect(()=>{a&&null!==l&&s(null)},[l,a]),(0,i.jsx)("div",{className:P().wrapper,children:(0,i.jsx)("div",{className:P().listContainer,children:(0,i.jsx)(c.bK,{droppableId:"played",direction:"horizontal",children:e=>(0,i.jsxs)("div",{ref:e.innerRef,...e.droppableProps,className:P().list,children:[(0,i.jsx)("div",{className:P().timelineContainer,children:(0,i.jsx)("div",{className:P().timeline})}),(0,i.jsx)("div",{className:P().items,children:n.map((e,a)=>(0,i.jsx)(Q,{draggable:null!==t,flippedId:l,index:a,item:e,setFlippedId:s},e.id))}),e.placeholder]})})})})}var N=a(4462),C=a.n(N),S=a(7686),I=a.n(S);function L(e){let{have:t}=e,{opacity:a}=(0,f.q_)({opacity:t?1:.4,config:{duration:300}}),{scale:r}=(0,f.q_)({scale:t?1:.8,config:{mass:1,tension:200,friction:20,duration:300},delay:200});return(0,i.jsx)(f.q.img,{className:I().heart,style:{opacity:a,scale:r},src:"/images/heart.svg"})}function D(e){let{lives:t}=e;return(0,i.jsxs)("div",{className:I().hearts,children:[(0,i.jsx)(L,{have:t>=1}),(0,i.jsx)(L,{have:t>=2}),(0,i.jsx)(L,{have:t>=3})]})}var E=a(6576),R=a.n(E),A=a(8925),M=a.n(A);function O(e){let{minimal:t=!1,onClick:a,text:r}=e;return(0,i.jsx)("button",{onClick:a,className:h()(M().button,{[M().minimal]:t}),children:r})}var B=a(1008),F=a.n(B);function W(e){let{score:t,title:a}=e,r="#ffffff";return t>=20?r="#FFC940":t>=10?r="#A7B6C2":t>=1&&(r="#C99765"),(0,i.jsxs)("div",{className:F().score,style:{backgroundColor:r},children:[(0,i.jsx)("div",{className:F().title,children:a}),(0,i.jsx)("div",{className:F().value,children:t})]})}let q="Share";function K(e){return e>=20?"\uD83E\uDD47 ":e>=10?"\uD83E\uDD48 ":e>=1?"\uD83E\uDD49 ":""}function H(e){let{highscore:t,resetGame:a,score:n}=e,l=(0,f.q_)({opacity:1,from:{opacity:0},config:{duration:500}}),[s,o]=r.useState(q),d=r.useCallback(async()=>{var e,a;await (null===(a=navigator)||void 0===a?void 0:null===(e=a.clipboard)||void 0===e?void 0:e.writeText("\uD83C\uDFDBï¸ wikitrivia.tomjwatson.com\n\n".concat(K(n),"Streak: ").concat(n,"\n").concat(K(t),"Best Streak: ").concat(t))),o("Copied"),setTimeout(()=>{o(q)},2e3)},[t,n]);return(0,i.jsxs)(f.q.div,{style:l,className:R().gameOver,children:[(0,i.jsxs)("div",{className:R().scoresWrapper,children:[(0,i.jsx)("div",{className:R().score,children:(0,i.jsx)(W,{score:n,title:"Streak"})}),(0,i.jsx)("div",{className:R().score,children:(0,i.jsx)(W,{score:t,title:"Best streak"})})]}),(0,i.jsxs)("div",{className:R().buttons,children:[(0,i.jsx)(O,{onClick:a,text:"Play again"}),(0,i.jsx)(O,{onClick:d,text:s,minimal:!0})]})]})}function T(e){let{highscore:t,resetGame:a,state:n,setState:l,updateHighscore:d}=e,[u,m]=r.useState(!1);async function h(){m(!0),navigator.vibrate(20)}async function f(e){m(!1);let{source:t,destination:a}=e;if(!a||null===n.next||"next"===t.droppableId&&"next"===a.droppableId)return;let i={...n.next};if("next"===t.droppableId&&"played"===a.droppableId){let e=[...n.deck],t=[...n.played],{correct:r,delta:d}=function(e,t,a){let i=[...e,t].sort((e,t)=>e.year-t.year).findIndex(e=>e.id===t.id);return a!==i?{correct:!1,delta:i-a}:{correct:!0,delta:0}}(t,i,a.index);t.splice(a.index,0,{...n.next,played:{correct:r}});let c=n.nextButOne,u=s(e,c?[...t,c]:t,n.playedIds),p=[o(u.image)];l({...n,deck:e,imageCache:p,next:c,nextButOne:u,played:t,lives:r?n.lives:n.lives-1,badlyPlaced:r?null:{index:a.index,rendered:!1,delta:d}}),n.playedIds.size===n.deck.length&&n.lives>0&&console.log("You win!")}else if("played"===t.droppableId&&"played"===a.droppableId){let e=[...n.played],[i]=e.splice(t.index,1);e.splice(a.index,0,i),l({...n,played:e,badlyPlaced:null})}}r.useLayoutEffect(()=>{n.badlyPlaced&&null!==n.badlyPlaced.index&&!n.badlyPlaced.rendered&&l({...n,badlyPlaced:{...n.badlyPlaced,rendered:!0}})},[l,n]);let _=r.useMemo(()=>n.played.filter(e=>e.played.correct).length-1,[n.played]);return r.useLayoutEffect(()=>{_>t&&d(_)},[_,t,d]),(0,i.jsx)(c.Z5,{onDragEnd:f,onDragStart:h,sensors:[p.bind(null,n)],children:(0,i.jsxs)("div",{className:C().wrapper,children:[(0,i.jsxs)("div",{className:C().top,children:[(0,i.jsx)(D,{lives:n.lives}),n.lives>0?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(j,{next:n.next})}):(0,i.jsx)(H,{highscore:t,resetGame:a,score:_})]}),(0,i.jsx)("div",{id:"bottom",className:C().bottom,children:(0,i.jsx)(k,{badlyPlacedIndex:null===n.badlyPlaced?null:n.badlyPlaced.index,isDragging:u,items:n.played})})]})})}var G=a(1607),U=a(3996),z=a.n(U);function J(){return(0,i.jsxs)("div",{className:z().loading,children:[(0,i.jsx)("h1",{children:"Loading"}),(0,i.jsx)(G.Z,{type:"Oval",color:"#006699",height:60,width:60})]})}var V=a(8930),Z=a(982),Y=a.n(Z);function X(e){let{highscore:t,start:a}=e;return(0,i.jsx)("div",{className:Y().instructions,children:(0,i.jsxs)("div",{className:Y().wrapper,children:[(0,i.jsx)("h2",{children:"Place the cards on the timeline in the correct order."}),0!==t&&(0,i.jsx)("div",{className:Y().highscoreWrapper,children:(0,i.jsx)(W,{score:t,title:"Best streak"})}),(0,i.jsx)(O,{onClick:a,text:"Start game"}),(0,i.jsxs)("div",{className:Y().about,children:[(0,i.jsxs)("div",{children:["All data sourced from"," ",(0,i.jsx)("a",{href:"https://www.wikidata.org",target:"_blank",rel:"noopener noreferrer",children:"Wikidata"})," ","and"," ",(0,i.jsx)("a",{href:"https://www.wikipedia.org",target:"_blank",rel:"noopener noreferrer",children:"Wikipedia"}),"."]}),(0,i.jsxs)("div",{children:["Have feedback? Please report it on"," ",(0,i.jsx)("a",{href:"https://github.com/tom-james-watson/wikitrivia/issues/",target:"_blank",rel:"noopener noreferrer",children:"GitHub"}),"."]}),(0,i.jsx)(V.Z,{href:"https://github.com/tom-james-watson/wikitrivia","data-size":"large","data-show-count":"true","aria-label":"Star tom-james-watson/wikitrivia on GitHub",children:"Star"})]})]})})}var $={Q745019:"Colt's Manufacturing Company",Q697675:"Gigabyte Technology",Q157064:"Puma (brand)",Q179900:"David (Michelangelo)",Q218567:"Law & Order SVU",Q486682:"Crips",Q12871:"Simon the Zealot",Q5505:"Lake Victoria",Q58784:"Das Kapital",Q345:"Virgin Mary",Q184742:"Metamorphoses",Q128267:"Joseph",Q60220:"Aeneid",Q25716:"1st millennium BC",Q134862:"Champagne",Q207193:"Skellig Michael",Q38526:"1,000,000",Q193159:"Russian Armed Forces",Q43343:"Folk music",Q10282403:"Surgical mask",Q46197:"Ascension",Q132851:"Admiral",Q55629:"Epsom Derby",Q828435:"Spanish conquest of the Aztec Empire",Q460584:"Scala",Q244157:"Igbo people",Q1990219:"French colonization of the Americas",Q321303:"The Garden of Earthly Delights",Q9730:"Classical music",Q221062:"DuPont",Q39427:"Surrealism",Q219995:"Guanches",Q833163:"Knight Bachelor",Q42233:"Sickle",Q80290:"Forbidden City",Q39950:"Vedas",Q468836:"Raedwald of East Anglia",Q73801:"Xbox Game Studios",Q81018:"Judas Iscariot",Q528187:"Pringles",Q187846:"Russian Alphabet",Q99309:"Pantheon, Rome",Q55:"Netherlands",Q80344:"Mount Olympus",Q161718:"United Nations Development Programme",Q3293295:"Turkish Naval Forces",Q1059358:"Rub\xe1iy\xe1t of Omar Khayy\xe1m",Q82996:"Runes",Q106187:"Giant's Causeway",Q213804:"Lindisfarne",Q229702:"Ham (son of Noah)",Q830183:"Eve",Q44996:"The Oxford English Dictionary",Q212746:"Anglo-Saxon Chronicle",Q41726:"Freemasonry",Q142:"France",Q115:"Ethiopia",Q12263:"Mahjong",Q213633:"Deborah",Q7734:"Joshua",Q202466:"Blond",Q94787:"Sunflower Oil",Q174640:"V-2 Rocket",Q1616457:"Mycroft Holmes",Q302:"Jesus",Q84422877:"Samaritan woman",Q917374:"Norwegian Armed Forces",Q718:"Chess",Q183:"Germany",Q38:"Italy",Q1649955:"Scarlett O'Hara",Q1768161:"Abraham in Islam",Q11768:"Ancient Egypt",Q304673:"Platoon",Q43982:"Bartholomew the Apostle",Q36:"Poland",Q47128:"Christmas Tree",Q242382:"Thusnelda",Q1069785:"Hong Kong Flu",Q183562:"Umayyad Mosque",Q82613:"Krakatoa",Q459188:"Kingdom of the Isles",Q465283:"Russian Navy",Q461606:"Ars\xe8ne Lupin",Q304690:"Li Ching-Yuen",Q2001966:"Company rule in India",Q651532:"The Three Little Pigs",Q184661:"Ogham",Q31057:"Norfolk Island",Q1246283:"Kumbhalgarh",Q735349:"Russian conquest of Siberia",Q2223341:"Elizabeth Bennet",Q40185:"Divine Comedy",Q2723024:"Enron scandal",Q133600:"Banksy",Q14112:"Corsica",Q1892745:"Salvator Mundi (Leonardo)",Q994776:"Brutalist architecture",Q182865:"War in Afghanistan",Q936394:"Pornhub",Q466683:"Chyna",Q824540:"AVN Awards",Q19559884:"August Ames",Q2709:"Sasha Grey",Q260794:"Sunny Leone",Q973475:"Dustin Diamond",Q3700050:"XVideos",Q18735049:"Mia Khalifa",Q233118:"Traci Lords",Q3916703:"Riley Reid",Q18749736:"Johnny Sins",Q65115154:"Belle Delphine",Q739550:"M&M's",Q1431121:"St Michael's Mount",Q174097:"Hogwarts",Q8690:"Cultural Revolution",Q149086:"Homicide"};function ee(){var e;let t=(0,l.useRouter)(),{deck:a}=t.query,[s,o]=(0,r.useState)(null),[c,u]=(0,r.useState)(!1),[p,m]=(0,r.useState)(!1),[h,f]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=async()=>{try{let e=(await n.Z.get("/".concat(a||"items",".json"))).data.trim().split("\n").map(e=>JSON.parse(e)).filter(e=>!(e.id in $));f(e)}catch(e){console.error("Failed to fetch items:",e)}};t.isReady&&e()},[a,t.isReady]),(0,r.useEffect)(()=>{(async()=>{null!==h&&(o(await d(h)),u(!0))})()},[h]);let _=r.useCallback(()=>{(async()=>{null!==h&&o(await d(h))})()},[h]),[g,y]=r.useState(Number(null!==(e=localStorage.getItem("highscore"))&&void 0!==e?e:"0")),x=r.useCallback(e=>{localStorage.setItem("highscore",String(e)),y(e)},[]);return c&&null!==s?p?(0,i.jsx)(T,{highscore:g,state:s,setState:o,resetGame:_,updateHighscore:x}):(0,i.jsx)(X,{highscore:g,start:()=>m(!0)}):(0,i.jsx)(J,{})}},4462:function(e){e.exports={wrapper:"board_wrapper__w_jA6",top:"board_top__tdv9c",bottom:"board_bottom__K5MJF"}},8925:function(e){e.exports={button:"button_button__7RcQL",minimal:"button_minimal__H8Bfn"}},6576:function(e){e.exports={gameOver:"game-over_gameOver__tjJx0",scoresWrapper:"game-over_scoresWrapper__DMQ1s",score:"game-over_score__V1XQi",buttons:"game-over_buttons__THiC5"}},7686:function(e){e.exports={hearts:"hearts_hearts__fQm9J",heart:"hearts_heart__NUxvT"}},982:function(e){e.exports={instructions:"instructions_instructions__30mpg",wrapper:"instructions_wrapper__Kx7f1",highscoreWrapper:"instructions_highscoreWrapper__yHhmb",about:"instructions_about__zzFbG"}},4549:function(e){e.exports={itemCard:"item-card_itemCard__uePGu",front:"item-card_front__53dPQ",back:"item-card_back__0h9af",dragging:"item-card_dragging__IpEKH",played:"item-card_played__tzVpq",flipped:"item-card_flipped__J7Ul3",top:"item-card_top__x5LfZ",image:"item-card_image__Up__i",bottom:"item-card_bottom__daGvg",correct:"item-card_correct__6lz_L",incorrect:"item-card_incorrect__iAtKa",description:"item-card_description__58evE",wikipedia:"item-card_wikipedia__W9y4r",date:"item-card_date__p1YP2",label:"item-card_label__RoOSe"}},3996:function(e){e.exports={loading:"loading_loading__UUl5K"}},7678:function(e){e.exports={container:"next-item-list_container__OsOIb",wrapper:"next-item-list_wrapper__j5n_Z",list:"next-item-list_list__OxhIi"}},9112:function(e){e.exports={wrapper:"played-item-list_wrapper__xlj9o",listContainer:"played-item-list_listContainer__wHzM5",timelineContainer:"played-item-list_timelineContainer__I9wUK",timeline:"played-item-list_timeline__rjEB0",list:"played-item-list_list__LR8_R",items:"played-item-list_items__2ytJU"}},1008:function(e){e.exports={score:"score_score__eTnbK",title:"score_title__blz5Y",value:"score_value__ZyP2i"}}}]);